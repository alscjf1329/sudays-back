#!/bin/bash
cd "$ROOT_DIR"

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "ğŸ“¦ í”„ë¡œì íŠ¸ ë£¨íŠ¸: $ROOT_DIR"

# â–¶ ê°€ìƒí™˜ê²½ ìƒì„±
if [ -d "$VENV_DIR" ]; then
    echo "âœ… ê°€ìƒí™˜ê²½ ì¡´ì¬í•¨: $VENV_DIR"
else
    echo "ğŸ› ï¸  ê°€ìƒí™˜ê²½ ìƒì„± ì¤‘..."
    python -m venv "$VENV_DIR"
fi

# â–¶ ê°€ìƒí™˜ê²½ í™œì„±í™” ê²½ë¡œ ì„¤ì •
if [[ "$OS_TYPE" == "linux"* ]]; then
    ACTIVATE_PATH="$VENV_DIR/bin/activate"
elif [[ "$OS_TYPE" == "windows" ]]; then
    ACTIVATE_PATH="$VENV_DIR/Scripts/activate"
else
    echo "âŒ ì§€ì›í•˜ì§€ ì•ŠëŠ” OS: $OS_TYPE"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    exit 1
fi

# â–¶ ê°€ìƒí™˜ê²½ í™œì„±í™”
if [ -f "$ACTIVATE_PATH" ]; then
    source "$ACTIVATE_PATH"
    echo "âœ… ê°€ìƒí™˜ê²½ í™œì„±í™”ë¨: $ACTIVATE_PATH"
else
    echo "âŒ activate íŒŒì¼ ì—†ìŒ: $ACTIVATE_PATH"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    exit 1
fi

# â–¶ pip ì—…ê·¸ë ˆì´ë“œ
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
echo "ğŸ”„ pip ì—…ê·¸ë ˆì´ë“œ ì¤‘..."
python -m pip install --upgrade pip > /dev/null
echo "âœ… pip ì—…ê·¸ë ˆì´ë“œ ì™„ë£Œ"

# â–¶ íŒ¨í‚¤ì§€ ì„¤ì¹˜
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
if [ -f "$ROOT_DIR/requirements.txt" ]; then
    echo "ğŸ“‚ requirements.txt ì„¤ì¹˜ ì¤‘..."
    pip install -r "$ROOT_DIR/requirements.txt"
    echo "âœ… íŒ¨í‚¤ì§€ ì„¤ì¹˜ ì™„ë£Œ"
else
    echo "âŒ requirements.txt íŒŒì¼ ì—†ìŒ: $ROOT_DIR/requirements.txt"
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    exit 1
fi

echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
